%uczenie predyktora arx
clear all;
n=0; farx(n+1)=8.925049e+004; foe(n+1)=8.954937e+004; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.408534e+004; foe(n+1)=1.592036e+005; krok(n+1)=3.355212e-004; ng(n+1)=7.980240e+004;
n=2; farx(n+1)=1.343408e+004; foe(n+1)=1.913330e+005; krok(n+1)=2.132008e-005; ng(n+1)=1.081892e+005;
n=3; farx(n+1)=6.665166e+003; foe(n+1)=9.855195e+004; krok(n+1)=4.790051e-005; ng(n+1)=4.880092e+004;
n=4; farx(n+1)=4.060475e+003; foe(n+1)=1.026102e+005; krok(n+1)=2.308086e-004; ng(n+1)=1.601394e+004;
n=5; farx(n+1)=3.860339e+003; foe(n+1)=1.033548e+005; krok(n+1)=3.021959e-006; ng(n+1)=3.832548e+004;
n=6; farx(n+1)=2.447538e+003; foe(n+1)=9.730137e+004; krok(n+1)=2.695564e-004; ng(n+1)=1.923475e+004;
n=7; farx(n+1)=1.734999e+003; foe(n+1)=1.738344e+005; krok(n+1)=1.360048e-004; ng(n+1)=2.377129e+004;
n=8; farx(n+1)=9.352087e+002; foe(n+1)=7.541569e+004; krok(n+1)=2.681467e-004; ng(n+1)=1.472899e+004;
n=9; farx(n+1)=8.495360e+002; foe(n+1)=6.514280e+004; krok(n+1)=2.478815e-004; ng(n+1)=1.773006e+004;
n=10; farx(n+1)=7.017117e+002; foe(n+1)=1.066643e+005; krok(n+1)=2.040240e-004; ng(n+1)=9.805267e+003;
n=11; farx(n+1)=5.310740e+002; foe(n+1)=4.408218e+004; krok(n+1)=6.277808e-004; ng(n+1)=8.727811e+003;
n=12; farx(n+1)=4.321757e+002; foe(n+1)=1.478102e+005; krok(n+1)=9.854180e-004; ng(n+1)=1.756762e+004;
n=13; farx(n+1)=3.091688e+002; foe(n+1)=8.086895e+004; krok(n+1)=1.556794e-003; ng(n+1)=8.443441e+003;
n=14; farx(n+1)=2.815316e+002; foe(n+1)=4.079582e+004; krok(n+1)=2.511123e-003; ng(n+1)=6.277558e+003;
n=15; farx(n+1)=2.671576e+002; foe(n+1)=3.676652e+004; krok(n+1)=2.076855e-003; ng(n+1)=8.188635e+003;
n=16; farx(n+1)=2.483544e+002; foe(n+1)=2.323326e+004; krok(n+1)=5.700116e-003; ng(n+1)=7.599495e+003;
n=17; farx(n+1)=2.341110e+002; foe(n+1)=3.065498e+004; krok(n+1)=7.088910e-003; ng(n+1)=8.869346e+003;
n=18; farx(n+1)=2.308746e+002; foe(n+1)=2.231816e+004; krok(n+1)=6.428545e-003; ng(n+1)=8.778786e+003;
n=19; farx(n+1)=2.221182e+002; foe(n+1)=2.404297e+004; krok(n+1)=1.080144e-002; ng(n+1)=9.387224e+003;
n=20; farx(n+1)=2.020948e+002; foe(n+1)=2.273981e+004; krok(n+1)=3.153338e-002; ng(n+1)=9.338162e+003;
n=21; farx(n+1)=1.916226e+002; foe(n+1)=5.019979e+004; krok(n+1)=2.243356e-002; ng(n+1)=8.716921e+003;
n=22; farx(n+1)=1.825314e+002; foe(n+1)=2.465516e+004; krok(n+1)=1.438335e-002; ng(n+1)=8.495249e+003;
n=23; farx(n+1)=1.548952e+002; foe(n+1)=1.461284e+004; krok(n+1)=5.042484e-002; ng(n+1)=7.580412e+003;
n=24; farx(n+1)=1.401630e+002; foe(n+1)=1.485485e+004; krok(n+1)=1.863402e-002; ng(n+1)=2.138191e+003;
n=25; farx(n+1)=1.073486e+002; foe(n+1)=1.542034e+004; krok(n+1)=7.786255e-002; ng(n+1)=2.063998e+003;
%odnowa zmiennej metryki
n=26; farx(n+1)=1.026638e+002; foe(n+1)=1.523104e+004; krok(n+1)=7.488252e-007; ng(n+1)=5.827623e+003;
n=27; farx(n+1)=9.723032e+001; foe(n+1)=2.019178e+004; krok(n+1)=8.191911e-005; ng(n+1)=1.256739e+003;
n=28; farx(n+1)=9.000646e+001; foe(n+1)=2.603144e+004; krok(n+1)=9.242591e-005; ng(n+1)=1.096424e+003;
n=29; farx(n+1)=8.438482e+001; foe(n+1)=3.654401e+004; krok(n+1)=2.638590e-004; ng(n+1)=1.453873e+003;
n=30; farx(n+1)=7.444277e+001; foe(n+1)=4.331169e+004; krok(n+1)=2.178264e-004; ng(n+1)=8.602728e+002;
n=31; farx(n+1)=6.245610e+001; foe(n+1)=3.483788e+004; krok(n+1)=1.060828e-003; ng(n+1)=1.036226e+003;
n=32; farx(n+1)=6.031299e+001; foe(n+1)=4.032421e+004; krok(n+1)=5.326130e-004; ng(n+1)=4.321739e+003;
n=33; farx(n+1)=5.523349e+001; foe(n+1)=3.664428e+004; krok(n+1)=1.573435e-003; ng(n+1)=4.295905e+003;
n=34; farx(n+1)=4.968544e+001; foe(n+1)=4.035495e+004; krok(n+1)=4.729451e-003; ng(n+1)=4.931743e+003;
n=35; farx(n+1)=4.584393e+001; foe(n+1)=7.496964e+004; krok(n+1)=1.153579e-002; ng(n+1)=6.275950e+003;
n=36; farx(n+1)=4.310227e+001; foe(n+1)=1.739448e+004; krok(n+1)=9.100900e-003; ng(n+1)=5.029338e+003;
n=37; farx(n+1)=3.927704e+001; foe(n+1)=1.050681e+004; krok(n+1)=1.496365e-002; ng(n+1)=3.113370e+003;
n=38; farx(n+1)=3.724248e+001; foe(n+1)=1.169716e+004; krok(n+1)=4.896932e-003; ng(n+1)=1.079047e+003;
n=39; farx(n+1)=3.447964e+001; foe(n+1)=6.971527e+003; krok(n+1)=6.192369e-003; ng(n+1)=8.522415e+002;
n=40; farx(n+1)=3.254998e+001; foe(n+1)=9.499941e+003; krok(n+1)=1.142218e-002; ng(n+1)=1.808202e+003;
n=41; farx(n+1)=3.069478e+001; foe(n+1)=8.959385e+003; krok(n+1)=1.396192e-002; ng(n+1)=1.747064e+003;
n=42; farx(n+1)=2.970170e+001; foe(n+1)=8.320820e+003; krok(n+1)=1.131031e-002; ng(n+1)=1.173247e+003;
n=43; farx(n+1)=2.809136e+001; foe(n+1)=8.840838e+003; krok(n+1)=1.297031e-002; ng(n+1)=1.656806e+003;
n=44; farx(n+1)=2.717961e+001; foe(n+1)=9.023425e+003; krok(n+1)=2.262062e-002; ng(n+1)=2.739666e+003;
n=45; farx(n+1)=2.615517e+001; foe(n+1)=1.366004e+004; krok(n+1)=2.065111e-002; ng(n+1)=2.600637e+003;
n=46; farx(n+1)=2.506608e+001; foe(n+1)=9.472575e+003; krok(n+1)=2.080702e-002; ng(n+1)=1.597496e+003;
n=47; farx(n+1)=2.388868e+001; foe(n+1)=9.414865e+003; krok(n+1)=2.610023e-002; ng(n+1)=1.123287e+003;
n=48; farx(n+1)=2.168859e+001; foe(n+1)=5.321173e+003; krok(n+1)=6.468141e-002; ng(n+1)=1.094509e+003;
n=49; farx(n+1)=2.088452e+001; foe(n+1)=5.513801e+003; krok(n+1)=3.907153e-002; ng(n+1)=8.537949e+002;
n=50; farx(n+1)=2.021149e+001; foe(n+1)=8.040457e+003; krok(n+1)=5.679907e-002; ng(n+1)=4.265767e+002;
%odnowa zmiennej metryki
n=51; farx(n+1)=2.017052e+001; foe(n+1)=6.536102e+003; krok(n+1)=5.881871e-007; ng(n+1)=7.212215e+002;
n=52; farx(n+1)=1.990754e+001; foe(n+1)=6.174080e+003; krok(n+1)=6.783250e-005; ng(n+1)=2.821151e+002;
n=53; farx(n+1)=1.957809e+001; foe(n+1)=8.347342e+003; krok(n+1)=1.007837e-004; ng(n+1)=2.737898e+002;
n=54; farx(n+1)=1.907519e+001; foe(n+1)=8.016233e+003; krok(n+1)=1.224225e-004; ng(n+1)=2.511706e+002;
n=55; farx(n+1)=1.858280e+001; foe(n+1)=7.043401e+003; krok(n+1)=4.228014e-004; ng(n+1)=1.792563e+002;
n=56; farx(n+1)=1.594574e+001; foe(n+1)=5.451554e+003; krok(n+1)=4.126268e-003; ng(n+1)=1.115350e+002;
n=57; farx(n+1)=1.578012e+001; foe(n+1)=5.771884e+003; krok(n+1)=5.362933e-004; ng(n+1)=1.345518e+003;
n=58; farx(n+1)=1.520264e+001; foe(n+1)=4.959879e+003; krok(n+1)=5.107684e-003; ng(n+1)=1.641942e+003;
n=59; farx(n+1)=1.452088e+001; foe(n+1)=1.125893e+004; krok(n+1)=5.038654e-003; ng(n+1)=1.218013e+003;
n=60; farx(n+1)=1.414790e+001; foe(n+1)=1.276775e+004; krok(n+1)=5.711090e-003; ng(n+1)=1.742199e+003;
n=61; farx(n+1)=1.396148e+001; foe(n+1)=1.288536e+004; krok(n+1)=5.214527e-003; ng(n+1)=1.734267e+003;
n=62; farx(n+1)=1.364148e+001; foe(n+1)=1.248082e+004; krok(n+1)=2.178313e-002; ng(n+1)=1.883582e+003;
n=63; farx(n+1)=1.320432e+001; foe(n+1)=1.264782e+004; krok(n+1)=2.607440e-002; ng(n+1)=1.550651e+003;
n=64; farx(n+1)=1.292555e+001; foe(n+1)=1.372596e+004; krok(n+1)=1.881038e-002; ng(n+1)=6.747244e+002;
n=65; farx(n+1)=1.281863e+001; foe(n+1)=1.259208e+004; krok(n+1)=2.194150e-002; ng(n+1)=3.777835e+002;
n=66; farx(n+1)=1.273336e+001; foe(n+1)=1.215923e+004; krok(n+1)=1.971968e-002; ng(n+1)=4.286168e+002;
n=67; farx(n+1)=1.265999e+001; foe(n+1)=1.215587e+004; krok(n+1)=2.606552e-002; ng(n+1)=3.375822e+002;
n=68; farx(n+1)=1.242127e+001; foe(n+1)=1.153610e+004; krok(n+1)=1.261335e-001; ng(n+1)=2.818982e+002;
n=69; farx(n+1)=1.225295e+001; foe(n+1)=1.180866e+004; krok(n+1)=1.729712e-002; ng(n+1)=1.862469e+002;
n=70; farx(n+1)=1.195738e+001; foe(n+1)=1.078617e+004; krok(n+1)=1.363489e-001; ng(n+1)=8.378884e+002;
n=71; farx(n+1)=1.175192e+001; foe(n+1)=1.069509e+004; krok(n+1)=4.757597e-002; ng(n+1)=7.023552e+002;
n=72; farx(n+1)=1.159855e+001; foe(n+1)=1.108154e+004; krok(n+1)=7.727538e-002; ng(n+1)=6.865414e+002;
n=73; farx(n+1)=1.155440e+001; foe(n+1)=1.110543e+004; krok(n+1)=3.252259e-002; ng(n+1)=6.298454e+002;
n=74; farx(n+1)=1.146319e+001; foe(n+1)=1.187483e+004; krok(n+1)=9.809225e-002; ng(n+1)=4.546435e+002;
n=75; farx(n+1)=1.135742e+001; foe(n+1)=1.127215e+004; krok(n+1)=8.509079e-002; ng(n+1)=4.669406e+002;
%odnowa zmiennej metryki
n=76; farx(n+1)=1.134878e+001; foe(n+1)=1.127350e+004; krok(n+1)=7.009401e-007; ng(n+1)=4.535619e+002;
n=77; farx(n+1)=1.126166e+001; foe(n+1)=1.129148e+004; krok(n+1)=1.927050e-005; ng(n+1)=3.059234e+002;
n=78; farx(n+1)=1.123538e+001; foe(n+1)=1.203516e+004; krok(n+1)=2.556688e-005; ng(n+1)=1.188159e+002;
n=79; farx(n+1)=1.121520e+001; foe(n+1)=1.130822e+004; krok(n+1)=3.682534e-004; ng(n+1)=3.096451e+001;
n=80; farx(n+1)=1.120026e+001; foe(n+1)=1.142284e+004; krok(n+1)=3.250430e-004; ng(n+1)=3.212170e+001;
n=81; farx(n+1)=1.115445e+001; foe(n+1)=1.152274e+004; krok(n+1)=2.388829e-003; ng(n+1)=3.813419e+001;
n=82; farx(n+1)=1.111439e+001; foe(n+1)=1.158293e+004; krok(n+1)=2.032662e-003; ng(n+1)=2.092294e+002;
n=83; farx(n+1)=1.104885e+001; foe(n+1)=1.204051e+004; krok(n+1)=2.121656e-003; ng(n+1)=2.991519e+002;
n=84; farx(n+1)=1.100840e+001; foe(n+1)=1.130401e+004; krok(n+1)=3.870712e-003; ng(n+1)=4.406860e+002;
n=85; farx(n+1)=1.095017e+001; foe(n+1)=1.160796e+004; krok(n+1)=1.345640e-002; ng(n+1)=5.331534e+002;
n=86; farx(n+1)=1.091969e+001; foe(n+1)=1.458687e+004; krok(n+1)=1.417782e-002; ng(n+1)=7.350938e+002;
n=87; farx(n+1)=1.090446e+001; foe(n+1)=1.247526e+004; krok(n+1)=1.238474e-002; ng(n+1)=7.970928e+002;
n=88; farx(n+1)=1.088201e+001; foe(n+1)=1.080112e+004; krok(n+1)=1.640492e-002; ng(n+1)=9.431995e+002;
n=89; farx(n+1)=1.086109e+001; foe(n+1)=1.109742e+004; krok(n+1)=3.350022e-002; ng(n+1)=9.443460e+002;
n=90; farx(n+1)=1.083946e+001; foe(n+1)=1.080793e+004; krok(n+1)=2.113019e-002; ng(n+1)=1.032398e+003;
n=91; farx(n+1)=1.081925e+001; foe(n+1)=1.049269e+004; krok(n+1)=2.667694e-002; ng(n+1)=1.082813e+003;
n=92; farx(n+1)=1.066297e+001; foe(n+1)=1.072634e+004; krok(n+1)=8.100548e-002; ng(n+1)=1.064015e+003;
n=93; farx(n+1)=1.062021e+001; foe(n+1)=1.075676e+004; krok(n+1)=3.300845e-002; ng(n+1)=5.801488e+002;
n=94; farx(n+1)=1.055800e+001; foe(n+1)=9.923456e+003; krok(n+1)=5.576355e-002; ng(n+1)=4.418074e+002;
n=95; farx(n+1)=1.052928e+001; foe(n+1)=9.551026e+003; krok(n+1)=2.477353e-002; ng(n+1)=1.641641e+002;
n=96; farx(n+1)=1.049087e+001; foe(n+1)=8.801917e+003; krok(n+1)=6.524238e-002; ng(n+1)=9.699854e+001;
n=97; farx(n+1)=1.044021e+001; foe(n+1)=8.970734e+003; krok(n+1)=4.815335e-002; ng(n+1)=1.907930e+002;
n=98; farx(n+1)=1.037975e+001; foe(n+1)=8.772270e+003; krok(n+1)=2.258989e-002; ng(n+1)=1.735118e+002;
n=99; farx(n+1)=1.023223e+001; foe(n+1)=8.879275e+003; krok(n+1)=1.057221e-001; ng(n+1)=2.445430e+002;
n=100; farx(n+1)=1.016666e+001; foe(n+1)=9.372890e+003; krok(n+1)=8.452792e-002; ng(n+1)=7.391275e+002;

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
